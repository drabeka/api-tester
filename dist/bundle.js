(()=>{var e=window.React,f=window.React.useState,T=window.React.useEffect,_=window.React.useRef,ae=window.React.createElement,ie=window.React.Fragment;var z=window.ReactDOM,ue=window.ReactDOM.createRoot;function K({apis:t,selectedApiId:s,onSelect:r}){return e.createElement("div",{className:"api-selector"},e.createElement("label",{htmlFor:"api-select"},"API ausw\xE4hlen:"),e.createElement("select",{id:"api-select",value:s||"",onChange:n=>{let d=n.target.value,c=t.find(m=>m.id===d);r(c)},className:"api-select-dropdown"},e.createElement("option",{value:""},"-- Bitte API w\xE4hlen --"),t.map(n=>e.createElement("option",{key:n.id,value:n.id},n.name," (",n.method,")"))),s&&e.createElement("div",{className:"api-info"},t.find(n=>n.id===s)?.description&&e.createElement("p",{className:"api-description"},t.find(n=>n.id===s).description)))}var N={HISTORY:"api_tester_history",FAVORITES:"api_tester_favorites",AUTH:"api_tester_auth"},te=20,k=(t,s=null)=>{try{let r=localStorage.getItem(t);return r?JSON.parse(r):s}catch(r){return console.error(`Error reading from localStorage (${t}):`,r),s}},x=(t,s)=>{try{return localStorage.setItem(t,JSON.stringify(s)),!0}catch(r){return console.error(`Error writing to localStorage (${t}):`,r),!1}},E=()=>k(N.HISTORY,[]),J=t=>{let s=E(),r={id:Date.now(),timestamp:new Date().toISOString(),...t},o=[r,...s].slice(0,te);return x(N.HISTORY,o),r},X=t=>{let r=E().filter(o=>o.id!==t);x(N.HISTORY,r)},Y=()=>{x(N.HISTORY,[])},V=()=>k(N.FAVORITES,[]),G=t=>{let s=V(),r=s.indexOf(t);return r>-1?s.splice(r,1):s.push(t),x(N.FAVORITES,s),s},W=t=>V().includes(t),I=t=>k(N.AUTH,{})[t]||null,Q=(t,s)=>{let r=k(N.AUTH,{});r[t]=s,x(N.AUTH,r)},Z=t=>{let s=k(N.AUTH,{});delete s[t],x(N.AUTH,s)};var se=3e4;async function R(t){let{endpoint:s,method:r="POST",payload:o={},authConfig:n=null,apiId:d,apiName:c,timeout:m=se,useProxy:h=!0,contentType:y="application/json",accept:b="*/*"}=t,l={};b&&(l.Accept=b);let i=o&&(typeof o=="string"?o.length>0:Object.keys(o).length>0);["POST","PUT","PATCH"].includes(r.toUpperCase())&&i&&(l["Content-Type"]=y),n&&(n.type==="bearer"?l.Authorization=`Bearer ${n.token}`:n.type==="apikey"&&(l[n.headerName||"X-API-Key"]=n.apiKey));let a=Date.now(),u=null,p=null,S=null;try{let v=new AbortController,P=setTimeout(()=>v.abort(),m),C,O;h?(O="/api/proxy",C={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:s,method:r,headers:l,body:["POST","PUT","PATCH"].includes(r.toUpperCase())?o:void 0}),signal:v.signal}):(O=s,C={method:r,headers:l,signal:v.signal},["POST","PUT","PATCH"].includes(r.toUpperCase())&&(C.body=JSON.stringify(o))),u=await fetch(O,C),clearTimeout(P);let M=await u.text();try{p=JSON.parse(M)}catch{p=M}}catch(v){S=v,v.name==="AbortError"&&(S=new Error(`Request timeout after ${m}ms`))}let F=Date.now()-a,g={apiId:d,apiName:c,endpoint:s,method:r,payload:o,status:u?u.status:0,statusText:u?u.statusText:"Network Error",responseData:p,error:S?S.message:null,duration:F};if(J(g),S)throw S;return{ok:u.ok,status:u.status,statusText:u.statusText,data:p,headers:Object.fromEntries(u.headers.entries()),duration:F}}function D(t){return typeof t=="object"?JSON.stringify(t,null,2):String(t)}function ee(t,s){let r={};return t.forEach(o=>{o.required&&!s[o.name]&&(r[o.name]=`${o.label} ist erforderlich`)}),{valid:Object.keys(r).length===0,errors:r}}function w({label:t,type:s="text",name:r,value:o,onChange:n,required:d=!1,error:c=null,placeholder:m="",step:h,rows:y=4,options:b=[],children:l,className:i=""}){let a=r||`field-${Math.random().toString(36).substr(2,9)}`,u=()=>s==="select"?e.createElement("select",{id:a,value:o||"",onChange:n,required:d},b.map(p=>e.createElement("option",{key:p.value,value:p.value},p.label))):s==="textarea"?e.createElement("textarea",{id:a,value:o||"",onChange:n,required:d,rows:y,placeholder:m}):e.createElement("input",{type:s,id:a,value:o||"",onChange:n,step:h,required:d,placeholder:m});return e.createElement("div",{className:`form-group ${i}`.trim()},e.createElement("label",{htmlFor:a},t,d&&e.createElement("span",{className:"required"},"*")),u(),c&&e.createElement("span",{className:"error-message"},c),l)}function A({icon:t,message:s,children:r,className:o=""}){return e.createElement("div",{className:`no-history ${o}`.trim()},t&&e.createElement("div",{style:{fontSize:"2em",marginBottom:"10px"}},t),e.createElement("p",null,s),r)}function $({api:t,onResponse:s,initialValues:r=null}){let[o,n]=f({}),[d,c]=f({}),[m,h]=f(!1);T(()=>{if(t){let i={};t.fields.forEach(a=>{r&&r[a.name]!==void 0?i[a.name]=r[a.name]:i[a.name]=a.defaultValue!==void 0?a.defaultValue:""}),n(i),c({})}},[t,r]);let y=(i,a)=>{n(u=>({...u,[i]:a})),d[i]&&c(u=>{let p={...u};return delete p[i],p})},b=async i=>{i.preventDefault();let a=ee(t.fields,o);if(!a.valid){c(a.errors);return}h(!0),c({});try{let u=I(t.id),p=await R({endpoint:t.endpoint,method:t.method,payload:o,authConfig:u,apiId:t.id,apiName:t.name,contentType:t.contentType,accept:t.accept});s(p)}catch(u){s({ok:!1,status:0,statusText:"Error",data:null,error:u.message})}finally{h(!1)}},l=i=>{i.ctrlKey&&i.key==="Enter"&&b(i)};return t?e.createElement("form",{className:"request-form",onSubmit:b,onKeyDown:l},t.fields.map(i=>{let a=u=>{let p=i.type==="number"?u.target.value===""?"":parseFloat(u.target.value):u.target.value;y(i.name,p)};return e.createElement(w,{key:i.name,label:i.label,type:i.type,name:i.name,value:o[i.name],onChange:a,required:i.required,error:d[i.name],step:i.step,rows:i.rows||4,options:i.options})}),e.createElement("div",{className:"form-actions"},e.createElement("button",{type:"submit",className:"btn-primary btn-submit",disabled:m},m?"Sende...":"API aufrufen"),e.createElement("small",{className:"hint"},"Tipp: Strg+Enter zum Absenden"))):e.createElement("div",{className:"request-form"},e.createElement(A,{icon:"\u{1F4DD}",message:"Bitte w\xE4hlen Sie eine API aus."}))}function H({variant:t="status",type:s="success",children:r,className:o=""}){let n="";return t==="status"?n=`status-badge ${s==="success"?"status-success":"status-error"}`:t==="duration"&&(n="duration-badge"),e.createElement("div",{className:`${n} ${o}`.trim()},r)}function q({response:t}){let s=_(null),r=o=>(typeof o!="string"&&(o=D(o)),o.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"([^"]+)":/g,'<span class="json-key">"$1"</span>:').replace(/: "([^"]*)"/g,': <span class="json-string">"$1"</span>').replace(/: (true|false)/g,': <span class="json-boolean">$1</span>').replace(/: (null)/g,': <span class="json-null">$1</span>').replace(/: (-?\d+\.?\d*)/g,': <span class="json-number">$1</span>'));return T(()=>{if(s.current&&t&&t.data!==null){let o=D(t.data),n=r(o);s.current.innerHTML=n}},[t]),t?e.createElement("div",{className:"response-viewer"},e.createElement("div",{className:"response-header"},e.createElement("h3",null,"Response"),e.createElement(H,{variant:"status",type:t.ok?"success":"error"},"HTTP ",t.status," ",t.statusText),t.duration&&e.createElement(H,{variant:"duration"},t.duration,"ms")),t.error?e.createElement("pre",{className:"response-content error"},"Fehler: ",t.error):e.createElement("pre",{ref:s,className:"response-content"})):e.createElement("div",{className:"response-viewer"},e.createElement("h3",null,"Response"),e.createElement("pre",{className:"response-content"},"Noch keine Anfrage gesendet."))}function B({apiId:t}){let[s,r]=f("none"),[o,n]=f(""),[d,c]=f(""),[m,h]=f("X-API-Key");T(()=>{if(t){let l=I(t);l?(r(l.type),n(l.token||""),c(l.apiKey||""),h(l.headerName||"X-API-Key")):(r("none"),n(""),c(""),h("X-API-Key"))}},[t]);let y=()=>{if(!t)return;let l={type:s};s==="bearer"?l.token=o:s==="apikey"&&(l.apiKey=d,l.headerName=m),Q(t,l),alert("Auth-Konfiguration gespeichert!")},b=()=>{t&&(Z(t),r("none"),n(""),c(""),h("X-API-Key"),alert("Auth-Konfiguration gel\xF6scht!"))};return t?e.createElement("div",{className:"auth-config"},e.createElement("h3",null,"Authentifizierung"),e.createElement(w,{label:"Auth-Typ:",type:"select",name:"auth-type",value:s,onChange:l=>r(l.target.value),options:[{value:"none",label:"Keine"},{value:"bearer",label:"Bearer Token"},{value:"apikey",label:"API Key"}]}),s==="bearer"&&e.createElement(w,{label:"Bearer Token:",type:"text",name:"bearer-token",value:o,onChange:l=>n(l.target.value),placeholder:"Token eingeben..."},e.createElement("small",{className:"warning"},"\u26A0\uFE0F Nur f\xFCr Testzwecke! Token wird in LocalStorage gespeichert.")),s==="apikey"&&e.createElement(e.Fragment,null,e.createElement(w,{label:"API Key:",type:"text",name:"api-key",value:d,onChange:l=>c(l.target.value),placeholder:"API Key eingeben..."}),e.createElement(w,{label:"Header-Name:",type:"text",name:"header-name",value:m,onChange:l=>h(l.target.value),placeholder:"z.B. X-API-Key"},e.createElement("small",{className:"warning"},"\u26A0\uFE0F Nur f\xFCr Testzwecke! Key wird in LocalStorage gespeichert."))),e.createElement("div",{className:"auth-actions"},e.createElement("button",{onClick:y,className:"btn-primary"},"Speichern"),e.createElement("button",{onClick:b,className:"btn-secondary"},"L\xF6schen"))):e.createElement("div",{className:"auth-config"},e.createElement(A,{icon:"\u{1F510}",message:"Bitte w\xE4hlen Sie zuerst eine API aus."}))}function U({item:t,isFavorite:s,onToggleFavorite:r,onReplay:o,onDelete:n}){let d=t.status>=200&&t.status<300?"status-success":"status-error",c=m=>new Date(m).toLocaleString("de-DE",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"});return e.createElement("div",{className:"history-item"},e.createElement("div",{className:"history-item-header"},e.createElement("span",{className:"api-name"},t.apiName),e.createElement("span",{className:`status ${d}`},t.status," ",t.statusText),e.createElement("span",{className:"timestamp"},c(t.timestamp))),e.createElement("div",{className:"history-item-details"},e.createElement("div",{className:"endpoint"},e.createElement("strong",null,t.method)," ",t.endpoint),t.duration&&e.createElement("div",{className:"duration"},t.duration,"ms")),e.createElement("div",{className:"history-item-actions"},e.createElement("button",{className:"btn-icon",onClick:()=>r(t.id),title:s?"Favorit entfernen":"Als Favorit markieren"},s?"\u2B50":"\u2606"),e.createElement("button",{className:"btn-small btn-primary",onClick:()=>o(t)},"\u21BB Wiederholen"),e.createElement("button",{className:"btn-small btn-danger",onClick:()=>n(t.id)},"\u{1F5D1}\uFE0F L\xF6schen")))}function L({onReplay:t}){let[s,r]=f([]),[o,n]=f([]),[d,c]=f("all"),m=()=>{let a=E();r(a);let u=a.filter(p=>W(p.id)).map(p=>p.id);n(u)};T(()=>{m()},[]);let h=a=>{confirm("M\xF6chten Sie diesen Eintrag wirklich l\xF6schen?")&&(X(a),m())},y=()=>{confirm("M\xF6chten Sie die gesamte Historie wirklich l\xF6schen?")&&(Y(),m())},b=a=>{G(a),m()},l=a=>{t({apiId:a.apiId,payload:a.payload})},i=d==="favorites"?s.filter(a=>o.includes(a.id)):s;return e.createElement("div",{className:"history"},e.createElement("div",{className:"history-header"},e.createElement("h3",null,"Request-Historie"),e.createElement("div",{className:"history-controls"},e.createElement("div",{className:"filter-buttons"},e.createElement("button",{className:d==="all"?"active":"",onClick:()=>c("all")},"Alle (",s.length,")"),e.createElement("button",{className:d==="favorites"?"active":"",onClick:()=>c("favorites")},"\u2B50 Favoriten (",o.length,")")),s.length>0&&e.createElement("button",{className:"btn-danger btn-small",onClick:y},"Alle l\xF6schen"))),i.length===0?e.createElement(A,{icon:d==="favorites"?"\u2B50":"\u{1F4DC}",message:d==="favorites"?"Keine Favoriten vorhanden.":"Noch keine Requests in der Historie."}):e.createElement("div",{className:"history-list"},i.map(a=>e.createElement(U,{key:a.id,item:a,isFavorite:o.includes(a.id),onToggleFavorite:b,onReplay:l,onDelete:h}))))}function j({tabs:t,activeTab:s,onChange:r,className:o=""}){return e.createElement("div",{className:`tabs ${o}`.trim()},t.map(n=>e.createElement("button",{key:n.id,className:`tab ${s===n.id?"active":""}`,onClick:()=>r(n.id)},n.label)))}function re(){let[t,s]=f([]),[r,o]=f(null),[n,d]=f(null),[c,m]=f(null),[h,y]=f("request"),[b,l]=f(!0),[i,a]=f(null);T(()=>{u()},[]);let u=async()=>{try{l(!0);let g=await fetch("/config/apis.json");if(!g.ok)throw new Error(`Fehler beim Laden der APIs: ${g.statusText}`);let v=await g.json();s(v.apis||[]),v.apis&&v.apis.length>0&&o(v.apis[0]),l(!1)}catch(g){a(g.message),l(!1),console.error("Fehler beim Laden der APIs:",g)}},p=g=>{o(g),d(null),m(null),y("request")},S=g=>{d(g)},F=g=>{let v=t.find(P=>P.id===g.apiId);v&&(o(v),m(g.payload),y("request"))};return b?e.createElement("div",{className:"app-container"},e.createElement("div",{className:"loading"},e.createElement("div",{className:"spinner"}),e.createElement("p",null,"Lade API-Konfiguration..."))):i?e.createElement("div",{className:"app-container"},e.createElement(A,{icon:"\u274C",message:"Fehler beim Laden"},e.createElement("p",{style:{marginTop:"10px"}},i),e.createElement("button",{onClick:u,className:"btn-primary",style:{marginTop:"15px"}},"Erneut versuchen"))):t.length===0?e.createElement("div",{className:"app-container"},e.createElement(A,{icon:"\u2699\uFE0F",message:"Keine APIs konfiguriert"},e.createElement("p",{style:{marginTop:"10px"}},"Bitte f\xFCgen Sie API-Definitionen in ",e.createElement("code",null,"config/apis.json")," hinzu."))):e.createElement("div",{className:"app-container"},e.createElement("header",{className:"app-header"},e.createElement("h1",null,"\u{1F680} API Test Framework"),e.createElement("p",{className:"subtitle"},"Flexibles Testing f\xFCr REST APIs")),e.createElement("div",{className:"api-selector-container"},e.createElement(K,{apis:t,selectedApiId:r?.id,onSelect:p})),e.createElement("div",{className:"main-content"},e.createElement("div",{className:"sidebar"},e.createElement(j,{activeTab:h,onChange:y,tabs:[{id:"request",label:"\u{1F4DD} Request"},{id:"auth",label:"\u{1F510} Auth"},{id:"history",label:"\u{1F4DC} Historie"}]}),e.createElement("div",{className:"tab-content"},h==="request"&&e.createElement($,{api:r,onResponse:S,initialValues:c}),h==="auth"&&e.createElement(B,{apiId:r?.id}),h==="history"&&e.createElement(L,{onReplay:F}))),e.createElement("div",{className:"response-panel"},e.createElement(q,{response:n}))),e.createElement("footer",{className:"app-footer"},e.createElement("p",null,"API Test Framework v1.0 | React + esbuild")))}var oe=z.createRoot(document.getElementById("root"));oe.render(e.createElement(re,null));})();
