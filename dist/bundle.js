(()=>{var e=window.React,d=window.React.useState,T=window.React.useEffect,K=window.React.useRef,Z=window.React.createElement,R=window.React.Fragment;var D=window.ReactDOM,te=window.ReactDOM.createRoot;function I({apis:t,selectedApiId:s,onSelect:n}){return e.createElement("div",{className:"api-selector"},e.createElement("label",{htmlFor:"api-select"},e.createElement("strong",null,"API ausw\xE4hlen:")),e.createElement("select",{id:"api-select",value:s||"",onChange:i=>{let c=i.target.value,p=t.find(m=>m.id===c);n(p)},className:"api-select-dropdown"},e.createElement("option",{value:""},"-- Bitte API w\xE4hlen --"),t.map(i=>e.createElement("option",{key:i.id,value:i.id},i.name," (",i.method,")"))),s&&e.createElement("div",{className:"api-info"},t.find(i=>i.id===s)?.description&&e.createElement("p",{className:"api-description"},t.find(i=>i.id===s).description)))}var N={HISTORY:"api_tester_history",FAVORITES:"api_tester_favorites",AUTH:"api_tester_auth"},Y=20,w=(t,s=null)=>{try{let n=localStorage.getItem(t);return n?JSON.parse(n):s}catch(n){return console.error(`Error reading from localStorage (${t}):`,n),s}},S=(t,s)=>{try{return localStorage.setItem(t,JSON.stringify(s)),!0}catch(n){return console.error(`Error writing to localStorage (${t}):`,n),!1}},x=()=>w(N.HISTORY,[]),$=t=>{let s=x(),n={id:Date.now(),timestamp:new Date().toISOString(),...t},u=[n,...s].slice(0,Y);return S(N.HISTORY,u),n},U=t=>{let n=x().filter(u=>u.id!==t);S(N.HISTORY,n)},L=()=>{S(N.HISTORY,[])},j=()=>w(N.FAVORITES,[]),B=t=>{let s=j(),n=s.indexOf(t);return n>-1?s.splice(n,1):s.push(t),S(N.FAVORITES,s),s},_=t=>j().includes(t),C=t=>w(N.AUTH,{})[t]||null,M=(t,s)=>{let n=w(N.AUTH,{});n[t]=s,S(N.AUTH,n)},z=t=>{let s=w(N.AUTH,{});delete s[t],S(N.AUTH,s)};var V=3e4;async function J(t){let{endpoint:s,method:n="POST",payload:u={},authConfig:i=null,apiId:c,apiName:p,timeout:m=V,useProxy:h=!0}=t,f={"Content-Type":"application/json"};i&&(i.type==="bearer"?f.Authorization=`Bearer ${i.token}`:i.type==="apikey"&&(f[i.headerName||"X-API-Key"]=i.apiKey));let A=Date.now(),a=null,r=null,l=null;try{let y=new AbortController,F=setTimeout(()=>y.abort(),m),v,b;h?(b="/api/proxy",v={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:s,method:n,headers:f,body:["POST","PUT","PATCH"].includes(n.toUpperCase())?u:void 0}),signal:y.signal}):(b=s,v={method:n,headers:f,signal:y.signal},["POST","PUT","PATCH"].includes(n.toUpperCase())&&(v.body=JSON.stringify(u))),a=await fetch(b,v),clearTimeout(F);let k=await a.text();try{r=JSON.parse(k)}catch{r=k}}catch(y){l=y,y.name==="AbortError"&&(l=new Error(`Request timeout after ${m}ms`))}let o=Date.now()-A,g={apiId:c,apiName:p,endpoint:s,method:n,payload:u,status:a?a.status:0,statusText:a?a.statusText:"Network Error",responseData:r,error:l?l.message:null,duration:o};if($(g),l)throw l;return{ok:a.ok,status:a.status,statusText:a.statusText,data:r,headers:Object.fromEntries(a.headers.entries()),duration:o}}function E(t){return typeof t=="object"?JSON.stringify(t,null,2):String(t)}function X(t,s){let n={};return t.forEach(u=>{u.required&&!s[u.name]&&(n[u.name]=`${u.label} ist erforderlich`)}),{valid:Object.keys(n).length===0,errors:n}}function H({api:t,onResponse:s,initialValues:n=null}){let[u,i]=d({}),[c,p]=d({}),[m,h]=d(!1);T(()=>{if(t){let r={};t.fields.forEach(l=>{n&&n[l.name]!==void 0?r[l.name]=n[l.name]:r[l.name]=l.defaultValue!==void 0?l.defaultValue:""}),i(r),p({})}},[t,n]);let f=(r,l)=>{i(o=>({...o,[r]:l})),c[r]&&p(o=>{let g={...o};return delete g[r],g})},A=async r=>{r.preventDefault();let l=X(t.fields,u);if(!l.valid){p(l.errors);return}h(!0),p({});try{let o=C(t.id),g=await J({endpoint:t.endpoint,method:t.method,payload:u,authConfig:o,apiId:t.id,apiName:t.name});s(g)}catch(o){s({ok:!1,status:0,statusText:"Error",data:null,error:o.message})}finally{h(!1)}},a=r=>{r.ctrlKey&&r.key==="Enter"&&A(r)};return t?e.createElement("form",{className:"request-form",onSubmit:A,onKeyDown:a},e.createElement("h3",null,t.name," \u2013 Request"),t.fields.map(r=>e.createElement("div",{key:r.name,className:"form-group"},e.createElement("label",{htmlFor:r.name},r.label,r.required&&e.createElement("span",{className:"required"},"*")),r.type==="select"?e.createElement("select",{id:r.name,value:u[r.name]||"",onChange:l=>f(r.name,l.target.value),required:r.required},r.options.map(l=>e.createElement("option",{key:l.value,value:l.value},l.label))):r.type==="textarea"?e.createElement("textarea",{id:r.name,value:u[r.name]||"",onChange:l=>f(r.name,l.target.value),required:r.required,rows:4}):e.createElement("input",{type:r.type,id:r.name,value:u[r.name]||"",onChange:l=>{let o=r.type==="number"?l.target.value===""?"":parseFloat(l.target.value):l.target.value;f(r.name,o)},step:r.step,required:r.required}),c[r.name]&&e.createElement("span",{className:"error-message"},c[r.name]))),e.createElement("div",{className:"form-actions"},e.createElement("button",{type:"submit",className:"btn-primary btn-submit",disabled:m},m?"Sende...":"API aufrufen"),e.createElement("small",{className:"hint"},"Tipp: Strg+Enter zum Absenden"))):e.createElement("div",{className:"request-form"},e.createElement("p",null,"Bitte w\xE4hlen Sie eine API aus."))}function P({response:t}){let s=K(null),n=i=>(typeof i!="string"&&(i=E(i)),i.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"([^"]+)":/g,'<span class="json-key">"$1"</span>:').replace(/: "([^"]*)"/g,': <span class="json-string">"$1"</span>').replace(/: (true|false)/g,': <span class="json-boolean">$1</span>').replace(/: (null)/g,': <span class="json-null">$1</span>').replace(/: (-?\d+\.?\d*)/g,': <span class="json-number">$1</span>'));if(T(()=>{if(s.current&&t&&t.data!==null){let i=E(t.data),c=n(i);s.current.innerHTML=c}},[t]),!t)return e.createElement("div",{className:"response-viewer"},e.createElement("h3",null,"Response"),e.createElement("pre",{className:"response-content"},"Noch keine Anfrage gesendet."));let u=t.ok?"status-success":"status-error";return e.createElement("div",{className:"response-viewer"},e.createElement("div",{className:"response-header"},e.createElement("h3",null,"Response"),e.createElement("div",{className:`status-badge ${u}`},"HTTP ",t.status," ",t.statusText),t.duration&&e.createElement("div",{className:"duration-badge"},t.duration,"ms")),t.error?e.createElement("pre",{className:"response-content error"},"Fehler: ",t.error):e.createElement("pre",{ref:s,className:"response-content"}))}function O({apiId:t}){let[s,n]=d("none"),[u,i]=d(""),[c,p]=d(""),[m,h]=d("X-API-Key");T(()=>{if(t){let a=C(t);a?(n(a.type),i(a.token||""),p(a.apiKey||""),h(a.headerName||"X-API-Key")):(n("none"),i(""),p(""),h("X-API-Key"))}},[t]);let f=()=>{if(!t)return;let a={type:s};s==="bearer"?a.token=u:s==="apikey"&&(a.apiKey=c,a.headerName=m),M(t,a),alert("Auth-Konfiguration gespeichert!")},A=()=>{t&&(z(t),n("none"),i(""),p(""),h("X-API-Key"),alert("Auth-Konfiguration gel\xF6scht!"))};return t?e.createElement("div",{className:"auth-config"},e.createElement("h3",null,"Authentifizierung"),e.createElement("div",{className:"form-group"},e.createElement("label",{htmlFor:"auth-type"},"Auth-Typ:"),e.createElement("select",{id:"auth-type",value:s,onChange:a=>n(a.target.value)},e.createElement("option",{value:"none"},"Keine"),e.createElement("option",{value:"bearer"},"Bearer Token"),e.createElement("option",{value:"apikey"},"API Key"))),s==="bearer"&&e.createElement("div",{className:"form-group"},e.createElement("label",{htmlFor:"bearer-token"},"Bearer Token:"),e.createElement("input",{type:"text",id:"bearer-token",value:u,onChange:a=>i(a.target.value),placeholder:"Token eingeben..."}),e.createElement("small",{className:"warning"},"\u26A0\uFE0F Nur f\xFCr Testzwecke! Token wird in LocalStorage gespeichert.")),s==="apikey"&&e.createElement(e.Fragment,null,e.createElement("div",{className:"form-group"},e.createElement("label",{htmlFor:"api-key"},"API Key:"),e.createElement("input",{type:"text",id:"api-key",value:c,onChange:a=>p(a.target.value),placeholder:"API Key eingeben..."})),e.createElement("div",{className:"form-group"},e.createElement("label",{htmlFor:"header-name"},"Header-Name:"),e.createElement("input",{type:"text",id:"header-name",value:m,onChange:a=>h(a.target.value),placeholder:"z.B. X-API-Key"})),e.createElement("small",{className:"warning"},"\u26A0\uFE0F Nur f\xFCr Testzwecke! Key wird in LocalStorage gespeichert.")),e.createElement("div",{className:"auth-actions"},e.createElement("button",{onClick:f,className:"btn-primary"},"Speichern"),e.createElement("button",{onClick:A,className:"btn-secondary"},"L\xF6schen"))):e.createElement("div",{className:"auth-config"},e.createElement("p",null,"Bitte w\xE4hlen Sie zuerst eine API aus."))}function q({onReplay:t}){let[s,n]=d([]),[u,i]=d([]),[c,p]=d("all"),m=()=>{let o=x();n(o);let g=o.filter(y=>_(y.id)).map(y=>y.id);i(g)};T(()=>{m()},[]);let h=o=>{confirm("M\xF6chten Sie diesen Eintrag wirklich l\xF6schen?")&&(U(o),m())},f=()=>{confirm("M\xF6chten Sie die gesamte Historie wirklich l\xF6schen?")&&(L(),m())},A=o=>{B(o),m()},a=o=>{t({apiId:o.apiId,payload:o.payload})},r=o=>new Date(o).toLocaleString("de-DE",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}),l=c==="favorites"?s.filter(o=>u.includes(o.id)):s;return e.createElement("div",{className:"history"},e.createElement("div",{className:"history-header"},e.createElement("h3",null,"Request-Historie"),e.createElement("div",{className:"history-controls"},e.createElement("div",{className:"filter-buttons"},e.createElement("button",{className:c==="all"?"active":"",onClick:()=>p("all")},"Alle (",s.length,")"),e.createElement("button",{className:c==="favorites"?"active":"",onClick:()=>p("favorites")},"\u2B50 Favoriten (",u.length,")")),s.length>0&&e.createElement("button",{className:"btn-danger btn-small",onClick:f},"Alle l\xF6schen"))),l.length===0?e.createElement("p",{className:"no-history"},c==="favorites"?"Keine Favoriten vorhanden.":"Noch keine Requests in der Historie."):e.createElement("div",{className:"history-list"},l.map(o=>{let g=o.status>=200&&o.status<300?"status-success":"status-error";return e.createElement("div",{key:o.id,className:"history-item"},e.createElement("div",{className:"history-item-header"},e.createElement("span",{className:"api-name"},o.apiName),e.createElement("span",{className:`status ${g}`},o.status," ",o.statusText),e.createElement("span",{className:"timestamp"},r(o.timestamp))),e.createElement("div",{className:"history-item-details"},e.createElement("div",{className:"endpoint"},e.createElement("strong",null,o.method)," ",o.endpoint),o.duration&&e.createElement("div",{className:"duration"},o.duration,"ms")),e.createElement("div",{className:"history-item-actions"},e.createElement("button",{className:"btn-icon",onClick:()=>A(o.id),title:u.includes(o.id)?"Favorit entfernen":"Als Favorit markieren"},u.includes(o.id)?"\u2B50":"\u2606"),e.createElement("button",{className:"btn-small btn-primary",onClick:()=>a(o)},"\u21BB Wiederholen"),e.createElement("button",{className:"btn-small btn-danger",onClick:()=>h(o.id)},"\u{1F5D1}\uFE0F L\xF6schen")))})))}function G(){let[t,s]=d([]),[n,u]=d(null),[i,c]=d(null),[p,m]=d(null),[h,f]=d("request"),[A,a]=d(!0),[r,l]=d(null);T(()=>{o()},[]);let o=async()=>{try{a(!0);let v=await fetch("/config/apis.json");if(!v.ok)throw new Error(`Fehler beim Laden der APIs: ${v.statusText}`);let b=await v.json();s(b.apis||[]),b.apis&&b.apis.length>0&&u(b.apis[0]),a(!1)}catch(v){l(v.message),a(!1),console.error("Fehler beim Laden der APIs:",v)}},g=v=>{u(v),c(null),m(null),f("request")},y=v=>{c(v)},F=v=>{let b=t.find(k=>k.id===v.apiId);b&&(u(b),m(v.payload),f("request"))};return A?e.createElement("div",{className:"app-container"},e.createElement("div",{className:"loading"},e.createElement("div",{className:"spinner"}),e.createElement("p",null,"Lade API-Konfiguration..."))):r?e.createElement("div",{className:"app-container"},e.createElement("div",{className:"error-container"},e.createElement("h2",null,"Fehler beim Laden"),e.createElement("p",null,r),e.createElement("button",{onClick:o,className:"btn-primary"},"Erneut versuchen"))):t.length===0?e.createElement("div",{className:"app-container"},e.createElement("div",{className:"error-container"},e.createElement("h2",null,"Keine APIs konfiguriert"),e.createElement("p",null,"Bitte f\xFCgen Sie API-Definitionen in ",e.createElement("code",null,"config/apis.json")," hinzu."))):e.createElement("div",{className:"app-container"},e.createElement("header",{className:"app-header"},e.createElement("h1",null,"\u{1F680} API Test Framework"),e.createElement("p",{className:"subtitle"},"Flexibles Testing f\xFCr REST APIs")),e.createElement("div",{className:"api-selector-container"},e.createElement(I,{apis:t,selectedApiId:n?.id,onSelect:g})),e.createElement("div",{className:"main-content"},e.createElement("div",{className:"sidebar"},e.createElement("div",{className:"tabs"},e.createElement("button",{className:`tab ${h==="request"?"active":""}`,onClick:()=>f("request")},"\u{1F4DD} Request"),e.createElement("button",{className:`tab ${h==="auth"?"active":""}`,onClick:()=>f("auth")},"\u{1F510} Auth"),e.createElement("button",{className:`tab ${h==="history"?"active":""}`,onClick:()=>f("history")},"\u{1F4DC} Historie")),e.createElement("div",{className:"tab-content"},h==="request"&&e.createElement(H,{api:n,onResponse:y,initialValues:p}),h==="auth"&&e.createElement(O,{apiId:n?.id}),h==="history"&&e.createElement(q,{onReplay:F}))),e.createElement("div",{className:"response-panel"},e.createElement(P,{response:i}))),e.createElement("footer",{className:"app-footer"},e.createElement("p",null,"API Test Framework v1.0 | React + esbuild")))}var W=D.createRoot(document.getElementById("root"));W.render(e.createElement(G,null));})();
