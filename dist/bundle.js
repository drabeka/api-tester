(()=>{var e=window.React,d=window.React.useState,A=window.React.useEffect,O=window.React.useRef,Q=window.React.createElement,Z=window.React.Fragment;var K=window.ReactDOM,ee=window.ReactDOM.createRoot;function F({apis:t,selectedApiId:s,onSelect:o}){return e.createElement("div",{className:"api-selector"},e.createElement("label",{htmlFor:"api-select"},e.createElement("strong",null,"API ausw\xE4hlen:")),e.createElement("select",{id:"api-select",value:s||"",onChange:i=>{let c=i.target.value,m=t.find(h=>h.id===c);o(m)},className:"api-select-dropdown"},e.createElement("option",{value:""},"-- Bitte API w\xE4hlen --"),t.map(i=>e.createElement("option",{key:i.id,value:i.id},i.name," (",i.method,")"))),s&&e.createElement("div",{className:"api-info"},t.find(i=>i.id===s)?.description&&e.createElement("p",{className:"api-description"},t.find(i=>i.id===s).description)))}var b={HISTORY:"api_tester_history",FAVORITES:"api_tester_favorites",AUTH:"api_tester_auth"},J=20,S=(t,s=null)=>{try{let o=localStorage.getItem(t);return o?JSON.parse(o):s}catch(o){return console.error(`Error reading from localStorage (${t}):`,o),s}},w=(t,s)=>{try{return localStorage.setItem(t,JSON.stringify(s)),!0}catch(o){return console.error(`Error writing to localStorage (${t}):`,o),!1}},k=()=>S(b.HISTORY,[]),D=t=>{let s=k(),o={id:Date.now(),timestamp:new Date().toISOString(),...t},u=[o,...s].slice(0,J);return w(b.HISTORY,u),o},$=t=>{let o=k().filter(u=>u.id!==t);w(b.HISTORY,o)},L=()=>{w(b.HISTORY,[])},B=()=>S(b.FAVORITES,[]),U=t=>{let s=B(),o=s.indexOf(t);return o>-1?s.splice(o,1):s.push(t),w(b.FAVORITES,s),s},_=t=>B().includes(t),x=t=>S(b.AUTH,{})[t]||null,j=(t,s)=>{let o=S(b.AUTH,{});o[t]=s,w(b.AUTH,o)},M=t=>{let s=S(b.AUTH,{});delete s[t],w(b.AUTH,s)};var V=3e4;async function z(t){let{endpoint:s,method:o="POST",payload:u={},authConfig:i=null,apiId:c,apiName:m,timeout:h=V}=t,p={"Content-Type":"application/json"};i&&(i.type==="bearer"?p.Authorization=`Bearer ${i.token}`:i.type==="apikey"&&(p[i.headerName||"X-API-Key"]=i.apiKey));let f={method:o,headers:p};["POST","PUT","PATCH"].includes(o.toUpperCase())&&(f.body=JSON.stringify(u));let N=Date.now(),a=null,r=null,l=null;try{let y=new AbortController,C=setTimeout(()=>y.abort(),h);f.signal=y.signal,a=await fetch(s,f),clearTimeout(C);let v=await a.text();try{r=JSON.parse(v)}catch{r=v}}catch(y){l=y,y.name==="AbortError"&&(l=new Error(`Request timeout after ${h}ms`))}let n=Date.now()-N,g={apiId:c,apiName:m,endpoint:s,method:o,payload:u,status:a?a.status:0,statusText:a?a.statusText:"Network Error",responseData:r,error:l?l.message:null,duration:n};if(D(g),l)throw l;return{ok:a.ok,status:a.status,statusText:a.statusText,data:r,headers:Object.fromEntries(a.headers.entries()),duration:n}}function I(t){return typeof t=="object"?JSON.stringify(t,null,2):String(t)}function X(t,s){let o={};return t.forEach(u=>{u.required&&!s[u.name]&&(o[u.name]=`${u.label} ist erforderlich`)}),{valid:Object.keys(o).length===0,errors:o}}function E({api:t,onResponse:s,initialValues:o=null}){let[u,i]=d({}),[c,m]=d({}),[h,p]=d(!1);A(()=>{if(t){let r={};t.fields.forEach(l=>{o&&o[l.name]!==void 0?r[l.name]=o[l.name]:r[l.name]=l.defaultValue!==void 0?l.defaultValue:""}),i(r),m({})}},[t,o]);let f=(r,l)=>{i(n=>({...n,[r]:l})),c[r]&&m(n=>{let g={...n};return delete g[r],g})},N=async r=>{r.preventDefault();let l=X(t.fields,u);if(!l.valid){m(l.errors);return}p(!0),m({});try{let n=x(t.id),g=await z({endpoint:t.endpoint,method:t.method,payload:u,authConfig:n,apiId:t.id,apiName:t.name});s(g)}catch(n){s({ok:!1,status:0,statusText:"Error",data:null,error:n.message})}finally{p(!1)}},a=r=>{r.ctrlKey&&r.key==="Enter"&&N(r)};return t?e.createElement("form",{className:"request-form",onSubmit:N,onKeyDown:a},e.createElement("h3",null,t.name," \u2013 Request"),t.fields.map(r=>e.createElement("div",{key:r.name,className:"form-group"},e.createElement("label",{htmlFor:r.name},r.label,r.required&&e.createElement("span",{className:"required"},"*")),r.type==="select"?e.createElement("select",{id:r.name,value:u[r.name]||"",onChange:l=>f(r.name,l.target.value),required:r.required},r.options.map(l=>e.createElement("option",{key:l.value,value:l.value},l.label))):r.type==="textarea"?e.createElement("textarea",{id:r.name,value:u[r.name]||"",onChange:l=>f(r.name,l.target.value),required:r.required,rows:4}):e.createElement("input",{type:r.type,id:r.name,value:u[r.name]||"",onChange:l=>{let n=r.type==="number"?l.target.value===""?"":parseFloat(l.target.value):l.target.value;f(r.name,n)},step:r.step,required:r.required}),c[r.name]&&e.createElement("span",{className:"error-message"},c[r.name]))),e.createElement("div",{className:"form-actions"},e.createElement("button",{type:"submit",className:"btn-primary btn-submit",disabled:h},h?"Sende...":"API aufrufen"),e.createElement("small",{className:"hint"},"Tipp: Strg+Enter zum Absenden"))):e.createElement("div",{className:"request-form"},e.createElement("p",null,"Bitte w\xE4hlen Sie eine API aus."))}function H({response:t}){let s=O(null),o=i=>(typeof i!="string"&&(i=I(i)),i.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"([^"]+)":/g,'<span class="json-key">"$1"</span>:').replace(/: "([^"]*)"/g,': <span class="json-string">"$1"</span>').replace(/: (true|false)/g,': <span class="json-boolean">$1</span>').replace(/: (null)/g,': <span class="json-null">$1</span>').replace(/: (-?\d+\.?\d*)/g,': <span class="json-number">$1</span>'));if(A(()=>{if(s.current&&t&&t.data!==null){let i=I(t.data),c=o(i);s.current.innerHTML=c}},[t]),!t)return e.createElement("div",{className:"response-viewer"},e.createElement("h3",null,"Response"),e.createElement("pre",{className:"response-content"},"Noch keine Anfrage gesendet."));let u=t.ok?"status-success":"status-error";return e.createElement("div",{className:"response-viewer"},e.createElement("div",{className:"response-header"},e.createElement("h3",null,"Response"),e.createElement("div",{className:`status-badge ${u}`},"HTTP ",t.status," ",t.statusText),t.duration&&e.createElement("div",{className:"duration-badge"},t.duration,"ms")),t.error?e.createElement("pre",{className:"response-content error"},"Fehler: ",t.error):e.createElement("pre",{ref:s,className:"response-content"}))}function P({apiId:t}){let[s,o]=d("none"),[u,i]=d(""),[c,m]=d(""),[h,p]=d("X-API-Key");A(()=>{if(t){let a=x(t);a?(o(a.type),i(a.token||""),m(a.apiKey||""),p(a.headerName||"X-API-Key")):(o("none"),i(""),m(""),p("X-API-Key"))}},[t]);let f=()=>{if(!t)return;let a={type:s};s==="bearer"?a.token=u:s==="apikey"&&(a.apiKey=c,a.headerName=h),j(t,a),alert("Auth-Konfiguration gespeichert!")},N=()=>{t&&(M(t),o("none"),i(""),m(""),p("X-API-Key"),alert("Auth-Konfiguration gel\xF6scht!"))};return t?e.createElement("div",{className:"auth-config"},e.createElement("h3",null,"Authentifizierung"),e.createElement("div",{className:"form-group"},e.createElement("label",{htmlFor:"auth-type"},"Auth-Typ:"),e.createElement("select",{id:"auth-type",value:s,onChange:a=>o(a.target.value)},e.createElement("option",{value:"none"},"Keine"),e.createElement("option",{value:"bearer"},"Bearer Token"),e.createElement("option",{value:"apikey"},"API Key"))),s==="bearer"&&e.createElement("div",{className:"form-group"},e.createElement("label",{htmlFor:"bearer-token"},"Bearer Token:"),e.createElement("input",{type:"text",id:"bearer-token",value:u,onChange:a=>i(a.target.value),placeholder:"Token eingeben..."}),e.createElement("small",{className:"warning"},"\u26A0\uFE0F Nur f\xFCr Testzwecke! Token wird in LocalStorage gespeichert.")),s==="apikey"&&e.createElement(e.Fragment,null,e.createElement("div",{className:"form-group"},e.createElement("label",{htmlFor:"api-key"},"API Key:"),e.createElement("input",{type:"text",id:"api-key",value:c,onChange:a=>m(a.target.value),placeholder:"API Key eingeben..."})),e.createElement("div",{className:"form-group"},e.createElement("label",{htmlFor:"header-name"},"Header-Name:"),e.createElement("input",{type:"text",id:"header-name",value:h,onChange:a=>p(a.target.value),placeholder:"z.B. X-API-Key"})),e.createElement("small",{className:"warning"},"\u26A0\uFE0F Nur f\xFCr Testzwecke! Key wird in LocalStorage gespeichert.")),e.createElement("div",{className:"auth-actions"},e.createElement("button",{onClick:f,className:"btn-primary"},"Speichern"),e.createElement("button",{onClick:N,className:"btn-secondary"},"L\xF6schen"))):e.createElement("div",{className:"auth-config"},e.createElement("p",null,"Bitte w\xE4hlen Sie zuerst eine API aus."))}function q({onReplay:t}){let[s,o]=d([]),[u,i]=d([]),[c,m]=d("all"),h=()=>{let n=k();o(n);let g=n.filter(y=>_(y.id)).map(y=>y.id);i(g)};A(()=>{h()},[]);let p=n=>{confirm("M\xF6chten Sie diesen Eintrag wirklich l\xF6schen?")&&($(n),h())},f=()=>{confirm("M\xF6chten Sie die gesamte Historie wirklich l\xF6schen?")&&(L(),h())},N=n=>{U(n),h()},a=n=>{t({apiId:n.apiId,payload:n.payload})},r=n=>new Date(n).toLocaleString("de-DE",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}),l=c==="favorites"?s.filter(n=>u.includes(n.id)):s;return e.createElement("div",{className:"history"},e.createElement("div",{className:"history-header"},e.createElement("h3",null,"Request-Historie"),e.createElement("div",{className:"history-controls"},e.createElement("div",{className:"filter-buttons"},e.createElement("button",{className:c==="all"?"active":"",onClick:()=>m("all")},"Alle (",s.length,")"),e.createElement("button",{className:c==="favorites"?"active":"",onClick:()=>m("favorites")},"\u2B50 Favoriten (",u.length,")")),s.length>0&&e.createElement("button",{className:"btn-danger btn-small",onClick:f},"Alle l\xF6schen"))),l.length===0?e.createElement("p",{className:"no-history"},c==="favorites"?"Keine Favoriten vorhanden.":"Noch keine Requests in der Historie."):e.createElement("div",{className:"history-list"},l.map(n=>{let g=n.status>=200&&n.status<300?"status-success":"status-error";return e.createElement("div",{key:n.id,className:"history-item"},e.createElement("div",{className:"history-item-header"},e.createElement("span",{className:"api-name"},n.apiName),e.createElement("span",{className:`status ${g}`},n.status," ",n.statusText),e.createElement("span",{className:"timestamp"},r(n.timestamp))),e.createElement("div",{className:"history-item-details"},e.createElement("div",{className:"endpoint"},e.createElement("strong",null,n.method)," ",n.endpoint),n.duration&&e.createElement("div",{className:"duration"},n.duration,"ms")),e.createElement("div",{className:"history-item-actions"},e.createElement("button",{className:"btn-icon",onClick:()=>N(n.id),title:u.includes(n.id)?"Favorit entfernen":"Als Favorit markieren"},u.includes(n.id)?"\u2B50":"\u2606"),e.createElement("button",{className:"btn-small btn-primary",onClick:()=>a(n)},"\u21BB Wiederholen"),e.createElement("button",{className:"btn-small btn-danger",onClick:()=>p(n.id)},"\u{1F5D1}\uFE0F L\xF6schen")))})))}function G(){let[t,s]=d([]),[o,u]=d(null),[i,c]=d(null),[m,h]=d(null),[p,f]=d("request"),[N,a]=d(!0),[r,l]=d(null);A(()=>{n()},[]);let n=async()=>{try{a(!0);let v=await fetch("/config/apis.json");if(!v.ok)throw new Error(`Fehler beim Laden der APIs: ${v.statusText}`);let T=await v.json();s(T.apis||[]),T.apis&&T.apis.length>0&&u(T.apis[0]),a(!1)}catch(v){l(v.message),a(!1),console.error("Fehler beim Laden der APIs:",v)}},g=v=>{u(v),c(null),h(null),f("request")},y=v=>{c(v)},C=v=>{let T=t.find(Y=>Y.id===v.apiId);T&&(u(T),h(v.payload),f("request"))};return N?e.createElement("div",{className:"app-container"},e.createElement("div",{className:"loading"},e.createElement("div",{className:"spinner"}),e.createElement("p",null,"Lade API-Konfiguration..."))):r?e.createElement("div",{className:"app-container"},e.createElement("div",{className:"error-container"},e.createElement("h2",null,"Fehler beim Laden"),e.createElement("p",null,r),e.createElement("button",{onClick:n,className:"btn-primary"},"Erneut versuchen"))):t.length===0?e.createElement("div",{className:"app-container"},e.createElement("div",{className:"error-container"},e.createElement("h2",null,"Keine APIs konfiguriert"),e.createElement("p",null,"Bitte f\xFCgen Sie API-Definitionen in ",e.createElement("code",null,"config/apis.json")," hinzu."))):e.createElement("div",{className:"app-container"},e.createElement("header",{className:"app-header"},e.createElement("h1",null,"\u{1F680} API Test Framework"),e.createElement("p",{className:"subtitle"},"Flexibles Testing f\xFCr REST APIs")),e.createElement("div",{className:"api-selector-container"},e.createElement(F,{apis:t,selectedApiId:o?.id,onSelect:g})),e.createElement("div",{className:"main-content"},e.createElement("div",{className:"sidebar"},e.createElement("div",{className:"tabs"},e.createElement("button",{className:`tab ${p==="request"?"active":""}`,onClick:()=>f("request")},"\u{1F4DD} Request"),e.createElement("button",{className:`tab ${p==="auth"?"active":""}`,onClick:()=>f("auth")},"\u{1F510} Auth"),e.createElement("button",{className:`tab ${p==="history"?"active":""}`,onClick:()=>f("history")},"\u{1F4DC} Historie")),e.createElement("div",{className:"tab-content"},p==="request"&&e.createElement(E,{api:o,onResponse:y,initialValues:m}),p==="auth"&&e.createElement(P,{apiId:o?.id}),p==="history"&&e.createElement(q,{onReplay:C}))),e.createElement("div",{className:"response-panel"},e.createElement(H,{response:i}))),e.createElement("footer",{className:"app-footer"},e.createElement("p",null,"API Test Framework v1.0 | React + esbuild")))}var W=K.createRoot(document.getElementById("root"));W.render(e.createElement(G,null));})();
