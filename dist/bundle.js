(()=>{var e=window.React,d=window.React.useState,T=window.React.useEffect,K=window.React.useRef,Z=window.React.createElement,R=window.React.Fragment;var D=window.ReactDOM,te=window.ReactDOM.createRoot;function I({apis:t,selectedApiId:s,onSelect:r}){return e.createElement("div",{className:"api-selector"},e.createElement("label",{htmlFor:"api-select"},e.createElement("strong",null,"API ausw\xE4hlen:")),e.createElement("select",{id:"api-select",value:s||"",onChange:i=>{let c=i.target.value,m=t.find(h=>h.id===c);r(m)},className:"api-select-dropdown"},e.createElement("option",{value:""},"-- Bitte API w\xE4hlen --"),t.map(i=>e.createElement("option",{key:i.id,value:i.id},i.name," (",i.method,")"))),s&&e.createElement("div",{className:"api-info"},t.find(i=>i.id===s)?.description&&e.createElement("p",{className:"api-description"},t.find(i=>i.id===s).description)))}var N={HISTORY:"api_tester_history",FAVORITES:"api_tester_favorites",AUTH:"api_tester_auth"},Y=20,w=(t,s=null)=>{try{let r=localStorage.getItem(t);return r?JSON.parse(r):s}catch(r){return console.error(`Error reading from localStorage (${t}):`,r),s}},S=(t,s)=>{try{return localStorage.setItem(t,JSON.stringify(s)),!0}catch(r){return console.error(`Error writing to localStorage (${t}):`,r),!1}},C=()=>w(N.HISTORY,[]),$=t=>{let s=C(),r={id:Date.now(),timestamp:new Date().toISOString(),...t},u=[r,...s].slice(0,Y);return S(N.HISTORY,u),r},U=t=>{let r=C().filter(u=>u.id!==t);S(N.HISTORY,r)},L=()=>{S(N.HISTORY,[])},j=()=>w(N.FAVORITES,[]),B=t=>{let s=j(),r=s.indexOf(t);return r>-1?s.splice(r,1):s.push(t),S(N.FAVORITES,s),s},_=t=>j().includes(t),x=t=>w(N.AUTH,{})[t]||null,M=(t,s)=>{let r=w(N.AUTH,{});r[t]=s,S(N.AUTH,r)},z=t=>{let s=w(N.AUTH,{});delete s[t],S(N.AUTH,s)};var V=3e4;async function J(t){let{endpoint:s,method:r="POST",payload:u={},authConfig:i=null,apiId:c,apiName:m,timeout:h=V,useProxy:f=!0}=t,p={};["POST","PUT","PATCH"].includes(r.toUpperCase())&&(p["Content-Type"]="application/json"),i&&(i.type==="bearer"?p.Authorization=`Bearer ${i.token}`:i.type==="apikey"&&(p[i.headerName||"X-API-Key"]=i.apiKey));let A=Date.now(),a=null,n=null,l=null;try{let y=new AbortController,F=setTimeout(()=>y.abort(),h),v,b;f?(b="/api/proxy",v={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:s,method:r,headers:p,body:["POST","PUT","PATCH"].includes(r.toUpperCase())?u:void 0}),signal:y.signal}):(b=s,v={method:r,headers:p,signal:y.signal},["POST","PUT","PATCH"].includes(r.toUpperCase())&&(v.body=JSON.stringify(u))),a=await fetch(b,v),clearTimeout(F);let k=await a.text();try{n=JSON.parse(k)}catch{n=k}}catch(y){l=y,y.name==="AbortError"&&(l=new Error(`Request timeout after ${h}ms`))}let o=Date.now()-A,g={apiId:c,apiName:m,endpoint:s,method:r,payload:u,status:a?a.status:0,statusText:a?a.statusText:"Network Error",responseData:n,error:l?l.message:null,duration:o};if($(g),l)throw l;return{ok:a.ok,status:a.status,statusText:a.statusText,data:n,headers:Object.fromEntries(a.headers.entries()),duration:o}}function E(t){return typeof t=="object"?JSON.stringify(t,null,2):String(t)}function X(t,s){let r={};return t.forEach(u=>{u.required&&!s[u.name]&&(r[u.name]=`${u.label} ist erforderlich`)}),{valid:Object.keys(r).length===0,errors:r}}function H({api:t,onResponse:s,initialValues:r=null}){let[u,i]=d({}),[c,m]=d({}),[h,f]=d(!1);T(()=>{if(t){let n={};t.fields.forEach(l=>{r&&r[l.name]!==void 0?n[l.name]=r[l.name]:n[l.name]=l.defaultValue!==void 0?l.defaultValue:""}),i(n),m({})}},[t,r]);let p=(n,l)=>{i(o=>({...o,[n]:l})),c[n]&&m(o=>{let g={...o};return delete g[n],g})},A=async n=>{n.preventDefault();let l=X(t.fields,u);if(!l.valid){m(l.errors);return}f(!0),m({});try{let o=x(t.id),g=await J({endpoint:t.endpoint,method:t.method,payload:u,authConfig:o,apiId:t.id,apiName:t.name});s(g)}catch(o){s({ok:!1,status:0,statusText:"Error",data:null,error:o.message})}finally{f(!1)}},a=n=>{n.ctrlKey&&n.key==="Enter"&&A(n)};return t?e.createElement("form",{className:"request-form",onSubmit:A,onKeyDown:a},e.createElement("h3",null,t.name," \u2013 Request"),t.fields.map(n=>e.createElement("div",{key:n.name,className:"form-group"},e.createElement("label",{htmlFor:n.name},n.label,n.required&&e.createElement("span",{className:"required"},"*")),n.type==="select"?e.createElement("select",{id:n.name,value:u[n.name]||"",onChange:l=>p(n.name,l.target.value),required:n.required},n.options.map(l=>e.createElement("option",{key:l.value,value:l.value},l.label))):n.type==="textarea"?e.createElement("textarea",{id:n.name,value:u[n.name]||"",onChange:l=>p(n.name,l.target.value),required:n.required,rows:4}):e.createElement("input",{type:n.type,id:n.name,value:u[n.name]||"",onChange:l=>{let o=n.type==="number"?l.target.value===""?"":parseFloat(l.target.value):l.target.value;p(n.name,o)},step:n.step,required:n.required}),c[n.name]&&e.createElement("span",{className:"error-message"},c[n.name]))),e.createElement("div",{className:"form-actions"},e.createElement("button",{type:"submit",className:"btn-primary btn-submit",disabled:h},h?"Sende...":"API aufrufen"),e.createElement("small",{className:"hint"},"Tipp: Strg+Enter zum Absenden"))):e.createElement("div",{className:"request-form"},e.createElement("p",null,"Bitte w\xE4hlen Sie eine API aus."))}function P({response:t}){let s=K(null),r=i=>(typeof i!="string"&&(i=E(i)),i.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"([^"]+)":/g,'<span class="json-key">"$1"</span>:').replace(/: "([^"]*)"/g,': <span class="json-string">"$1"</span>').replace(/: (true|false)/g,': <span class="json-boolean">$1</span>').replace(/: (null)/g,': <span class="json-null">$1</span>').replace(/: (-?\d+\.?\d*)/g,': <span class="json-number">$1</span>'));if(T(()=>{if(s.current&&t&&t.data!==null){let i=E(t.data),c=r(i);s.current.innerHTML=c}},[t]),!t)return e.createElement("div",{className:"response-viewer"},e.createElement("h3",null,"Response"),e.createElement("pre",{className:"response-content"},"Noch keine Anfrage gesendet."));let u=t.ok?"status-success":"status-error";return e.createElement("div",{className:"response-viewer"},e.createElement("div",{className:"response-header"},e.createElement("h3",null,"Response"),e.createElement("div",{className:`status-badge ${u}`},"HTTP ",t.status," ",t.statusText),t.duration&&e.createElement("div",{className:"duration-badge"},t.duration,"ms")),t.error?e.createElement("pre",{className:"response-content error"},"Fehler: ",t.error):e.createElement("pre",{ref:s,className:"response-content"}))}function O({apiId:t}){let[s,r]=d("none"),[u,i]=d(""),[c,m]=d(""),[h,f]=d("X-API-Key");T(()=>{if(t){let a=x(t);a?(r(a.type),i(a.token||""),m(a.apiKey||""),f(a.headerName||"X-API-Key")):(r("none"),i(""),m(""),f("X-API-Key"))}},[t]);let p=()=>{if(!t)return;let a={type:s};s==="bearer"?a.token=u:s==="apikey"&&(a.apiKey=c,a.headerName=h),M(t,a),alert("Auth-Konfiguration gespeichert!")},A=()=>{t&&(z(t),r("none"),i(""),m(""),f("X-API-Key"),alert("Auth-Konfiguration gel\xF6scht!"))};return t?e.createElement("div",{className:"auth-config"},e.createElement("h3",null,"Authentifizierung"),e.createElement("div",{className:"form-group"},e.createElement("label",{htmlFor:"auth-type"},"Auth-Typ:"),e.createElement("select",{id:"auth-type",value:s,onChange:a=>r(a.target.value)},e.createElement("option",{value:"none"},"Keine"),e.createElement("option",{value:"bearer"},"Bearer Token"),e.createElement("option",{value:"apikey"},"API Key"))),s==="bearer"&&e.createElement("div",{className:"form-group"},e.createElement("label",{htmlFor:"bearer-token"},"Bearer Token:"),e.createElement("input",{type:"text",id:"bearer-token",value:u,onChange:a=>i(a.target.value),placeholder:"Token eingeben..."}),e.createElement("small",{className:"warning"},"\u26A0\uFE0F Nur f\xFCr Testzwecke! Token wird in LocalStorage gespeichert.")),s==="apikey"&&e.createElement(e.Fragment,null,e.createElement("div",{className:"form-group"},e.createElement("label",{htmlFor:"api-key"},"API Key:"),e.createElement("input",{type:"text",id:"api-key",value:c,onChange:a=>m(a.target.value),placeholder:"API Key eingeben..."})),e.createElement("div",{className:"form-group"},e.createElement("label",{htmlFor:"header-name"},"Header-Name:"),e.createElement("input",{type:"text",id:"header-name",value:h,onChange:a=>f(a.target.value),placeholder:"z.B. X-API-Key"})),e.createElement("small",{className:"warning"},"\u26A0\uFE0F Nur f\xFCr Testzwecke! Key wird in LocalStorage gespeichert.")),e.createElement("div",{className:"auth-actions"},e.createElement("button",{onClick:p,className:"btn-primary"},"Speichern"),e.createElement("button",{onClick:A,className:"btn-secondary"},"L\xF6schen"))):e.createElement("div",{className:"auth-config"},e.createElement("p",null,"Bitte w\xE4hlen Sie zuerst eine API aus."))}function q({onReplay:t}){let[s,r]=d([]),[u,i]=d([]),[c,m]=d("all"),h=()=>{let o=C();r(o);let g=o.filter(y=>_(y.id)).map(y=>y.id);i(g)};T(()=>{h()},[]);let f=o=>{confirm("M\xF6chten Sie diesen Eintrag wirklich l\xF6schen?")&&(U(o),h())},p=()=>{confirm("M\xF6chten Sie die gesamte Historie wirklich l\xF6schen?")&&(L(),h())},A=o=>{B(o),h()},a=o=>{t({apiId:o.apiId,payload:o.payload})},n=o=>new Date(o).toLocaleString("de-DE",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}),l=c==="favorites"?s.filter(o=>u.includes(o.id)):s;return e.createElement("div",{className:"history"},e.createElement("div",{className:"history-header"},e.createElement("h3",null,"Request-Historie"),e.createElement("div",{className:"history-controls"},e.createElement("div",{className:"filter-buttons"},e.createElement("button",{className:c==="all"?"active":"",onClick:()=>m("all")},"Alle (",s.length,")"),e.createElement("button",{className:c==="favorites"?"active":"",onClick:()=>m("favorites")},"\u2B50 Favoriten (",u.length,")")),s.length>0&&e.createElement("button",{className:"btn-danger btn-small",onClick:p},"Alle l\xF6schen"))),l.length===0?e.createElement("p",{className:"no-history"},c==="favorites"?"Keine Favoriten vorhanden.":"Noch keine Requests in der Historie."):e.createElement("div",{className:"history-list"},l.map(o=>{let g=o.status>=200&&o.status<300?"status-success":"status-error";return e.createElement("div",{key:o.id,className:"history-item"},e.createElement("div",{className:"history-item-header"},e.createElement("span",{className:"api-name"},o.apiName),e.createElement("span",{className:`status ${g}`},o.status," ",o.statusText),e.createElement("span",{className:"timestamp"},n(o.timestamp))),e.createElement("div",{className:"history-item-details"},e.createElement("div",{className:"endpoint"},e.createElement("strong",null,o.method)," ",o.endpoint),o.duration&&e.createElement("div",{className:"duration"},o.duration,"ms")),e.createElement("div",{className:"history-item-actions"},e.createElement("button",{className:"btn-icon",onClick:()=>A(o.id),title:u.includes(o.id)?"Favorit entfernen":"Als Favorit markieren"},u.includes(o.id)?"\u2B50":"\u2606"),e.createElement("button",{className:"btn-small btn-primary",onClick:()=>a(o)},"\u21BB Wiederholen"),e.createElement("button",{className:"btn-small btn-danger",onClick:()=>f(o.id)},"\u{1F5D1}\uFE0F L\xF6schen")))})))}function G(){let[t,s]=d([]),[r,u]=d(null),[i,c]=d(null),[m,h]=d(null),[f,p]=d("request"),[A,a]=d(!0),[n,l]=d(null);T(()=>{o()},[]);let o=async()=>{try{a(!0);let v=await fetch("/config/apis.json");if(!v.ok)throw new Error(`Fehler beim Laden der APIs: ${v.statusText}`);let b=await v.json();s(b.apis||[]),b.apis&&b.apis.length>0&&u(b.apis[0]),a(!1)}catch(v){l(v.message),a(!1),console.error("Fehler beim Laden der APIs:",v)}},g=v=>{u(v),c(null),h(null),p("request")},y=v=>{c(v)},F=v=>{let b=t.find(k=>k.id===v.apiId);b&&(u(b),h(v.payload),p("request"))};return A?e.createElement("div",{className:"app-container"},e.createElement("div",{className:"loading"},e.createElement("div",{className:"spinner"}),e.createElement("p",null,"Lade API-Konfiguration..."))):n?e.createElement("div",{className:"app-container"},e.createElement("div",{className:"error-container"},e.createElement("h2",null,"Fehler beim Laden"),e.createElement("p",null,n),e.createElement("button",{onClick:o,className:"btn-primary"},"Erneut versuchen"))):t.length===0?e.createElement("div",{className:"app-container"},e.createElement("div",{className:"error-container"},e.createElement("h2",null,"Keine APIs konfiguriert"),e.createElement("p",null,"Bitte f\xFCgen Sie API-Definitionen in ",e.createElement("code",null,"config/apis.json")," hinzu."))):e.createElement("div",{className:"app-container"},e.createElement("header",{className:"app-header"},e.createElement("h1",null,"\u{1F680} API Test Framework"),e.createElement("p",{className:"subtitle"},"Flexibles Testing f\xFCr REST APIs")),e.createElement("div",{className:"api-selector-container"},e.createElement(I,{apis:t,selectedApiId:r?.id,onSelect:g})),e.createElement("div",{className:"main-content"},e.createElement("div",{className:"sidebar"},e.createElement("div",{className:"tabs"},e.createElement("button",{className:`tab ${f==="request"?"active":""}`,onClick:()=>p("request")},"\u{1F4DD} Request"),e.createElement("button",{className:`tab ${f==="auth"?"active":""}`,onClick:()=>p("auth")},"\u{1F510} Auth"),e.createElement("button",{className:`tab ${f==="history"?"active":""}`,onClick:()=>p("history")},"\u{1F4DC} Historie")),e.createElement("div",{className:"tab-content"},f==="request"&&e.createElement(H,{api:r,onResponse:y,initialValues:m}),f==="auth"&&e.createElement(O,{apiId:r?.id}),f==="history"&&e.createElement(q,{onReplay:F}))),e.createElement("div",{className:"response-panel"},e.createElement(P,{response:i}))),e.createElement("footer",{className:"app-footer"},e.createElement("p",null,"API Test Framework v1.0 | React + esbuild")))}var W=D.createRoot(document.getElementById("root"));W.render(e.createElement(G,null));})();
